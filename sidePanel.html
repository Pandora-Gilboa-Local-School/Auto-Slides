<!DOCTYPE html>
<html>

<head>
  
  <base target="_top">

  <!-- Include CSS -->
  <?!= HtmlService.createHtmlOutputFromFile('sidePanel_css').getContent(); ?>
  
</head>
 
<body>
      
  <div class="row"> 
    
    <!-- Script Settings -->

    <form class="col s12" id="formconfigure">       
      <div class="row">
        <div class="input-field col s12">
          <label for="sAdvance">Automatic advance every (s)</label>
          <input class="validate" type="number" name="sAdvance" value="<?= sAdvance ?>" min="1" step="1" id="sAdvance">
        </div>
      </div>
        
      <div class="row">
        <div class="input-field col s12">
          <label for="sReload">Reload presentation every (s) [0 = never]</label>
          <input class="validate" type="number" name="sReload" value="<?= sReload ?>" min="0" step="1" id="sReload">
        </div>
      </div> 
        
      <div class="row">
        <div class="input-field col s12">
          <label for="msFade">Fade (ms)</label>
          <input class="validate" type="number" name="msFade" value="<?= msFade ?>" min="1000" step="100" id="msFade">
        </div>
      </div>
        
      <div class="row">
        <div class="input-field col s12">
          <label>
            <input name="start" type="checkbox" class="filled-in" <?= start ?> id="start"/>
            <span>Start automatically</span>
          </label>
        </div>
      </div>
        
      <div class="row">
        <div class="input-field col s12">
          <label>
            <input name="repeat" type="checkbox" class="filled-in" <?= repeat ?>  id="repeat"/>
            <span>Repeat</span>
          </label>
        </div>
      </div>
        
      <div class="row">
        <div class="input-field col s12">
          <label>
            <input name="hideMenu" type="checkbox" class="filled-in" <?= hideMenu ?>  id ="hideMenu"/>
            <span>Hide Embedded Menu</span>
          </label>
        </div>
      </div>
        
      <div class="row">
        <div class="input-field col s12">
          <label>
            <input name="hideBands" type="checkbox" class="filled-in" <?= hideBands ?>  id ="hideBands"/>
            <span>Hide Side Bars</span>
          </label>
        </div>
      </div>        

      <div class="row">
        <div class="input-field col s12">
          <label>
            <input name="hideBorders" type="checkbox" class="filled-in" <?= hideBorders ?>  id ="hideBorders"/>
            <span>Hide Frame Borders</span>
          </label>
        </div>
      </div>   
        
      <div class="row">
        <div class="input-field col s12">
          <label for="backgroundColor">
            <input type="color" name="backgroundColor" value="<?= backgroundColor ?>" id="backgroundColor">
            <span>Background Color</span>
          </label>
        </div>
      </div>
        
    </form>
  </div>
    
  <div class="row">
    <button id="saveButton" class="btn waves-effect waves-light col s8">Confirm</button>
    <div class="col s1"></div>
    <button id="resetButton" class="btn pink darken-1 waves-effect waves-light col s3">Reset</button>
  </div>
    
  <!-- Show number of linked HDC charts in the presentation + instructions  -->
    
  <? if (countSheetCharts() > 0 ) { ?>
    <p><b><?= numCharts ?></b> Chart graphics have been detected. Configure a temporary trigger if you want the presentation to update when they change.</p>
    <ul class="collapsible">
      <li>
        <div class="collapsible-header"><i class="material-icons">info_outline</i>Instructions</div>
        <div class="collapsible-body">
          <span><ol>
            <li>Extensions > Script editor.</li>
            <li>Edit > Project triggers.</li>
            <li>Add a trigger.</li>
            <li>Function: <i>refreshLinkedGraphicsHdc</i>.</li>
            <li>Source: <i>Time-driven.</i></li>
            <li>Set <i>type</i> and <i>interval</i>.</li>
            <li>Save.</li>
            <img class="responsive-img materialboxed" src="">
          </ol></span>
        </div>
      </li>
    </ul>
  <?}?>
    
  <!-- Include JS -->
  <?!= HtmlService.createHtmlOutputFromFile('sidePanel_js').getContent(); ?>
  
</body>

</html>